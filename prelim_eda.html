
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Load Stockmarket Data &#8212; NLP Cluster Network</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "https://github.com/AndrewDamico/nlpnetworkanalysis");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ðŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">NLP Cluster Network</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Vision Inference Processing Endogenous Robot
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="readme.html">
   1. Hello
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="docs/communication_diagram.html">
   2. Viper Communication Diagram
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="docs/process_diagram.html">
   3. Viper Data Process Diagram
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Hardware
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="docs/Hardware.html">
   Hardware Configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.raspberrypi.com/">
   Raspberry Pi
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Software
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="docs/Software.html">
   Software Configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/AndrewDamico/viper">
   VIPER GitHub Repository
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://mate-desktop.org/">
   Mate Desktop
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.ubuntu.com">
   Ubuntu
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.intel.com/content/www/us/en/developer/tools/neural-compute-stick/overview.html">
   Intel Neural Compute Stick 2
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/prelim_eda.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/AndrewDamico/nlpnetworkanalysis"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/AndrewDamico/nlpnetworkanalysis/issues/new?title=Issue%20on%20page%20%2Fprelim_eda.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/AndrewDamico/nlpnetworkanalysis/edit/main/https://andrewdamico.github.io/nlpnetworkanalysis/prelim_eda.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/AndrewDamico/nlpnetworkanalysis/main?urlpath=tree/https://andrewdamico.github.io/nlpnetworkanalysis/prelim_eda.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Load Stockmarket Data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verify-that-the-spy-etf-is-correlated-with-the-s-p-500">
     Verify that the SPY ETF is correlated with the S&amp;P 500
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#feature-engineering">
     Feature Engineering
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#day-week-month">
       Day Week Month
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#baseline-model">
   Baseline Model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-training-packets">
     Create Training Packets
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#split-training-test">
     Split Training/Test
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model">
     Model
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Load Stockmarket Data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Load Stockmarket Data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verify-that-the-spy-etf-is-correlated-with-the-s-p-500">
     Verify that the SPY ETF is correlated with the S&amp;P 500
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#feature-engineering">
     Feature Engineering
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#day-week-month">
       Day Week Month
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#baseline-model">
   Baseline Model
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-training-packets">
     Create Training Packets
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#split-training-test">
     Split Training/Test
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model">
     Model
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">keras</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">LSTM</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="kn">import</span> <span class="n">EarlyStopping</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [1],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pandas&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Num GPUs Available: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">list_physical_devices</span><span class="p">(</span><span class="s1">&#39;GPU&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Num GPUs Available:  1
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="load-stockmarket-data">
<h1>Load Stockmarket Data<a class="headerlink" href="#load-stockmarket-data" title="Permalink to this headline">Â¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp500</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;sp500.csv&quot;</span><span class="p">)</span>
<span class="n">spy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;spy.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp500</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>close_adj</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/18/2012</td>
      <td>1293.65</td>
      <td>1308.11</td>
      <td>1290.99</td>
      <td>1308.04</td>
      <td>1308.04</td>
      <td>4.096160e+09</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1/19/2012</td>
      <td>1308.07</td>
      <td>1315.49</td>
      <td>1308.07</td>
      <td>1314.50</td>
      <td>1314.50</td>
      <td>4.465890e+09</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1/20/2012</td>
      <td>1314.49</td>
      <td>1315.38</td>
      <td>1309.17</td>
      <td>1315.38</td>
      <td>1315.38</td>
      <td>3.912620e+09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1/23/2012</td>
      <td>1315.29</td>
      <td>1322.28</td>
      <td>1309.89</td>
      <td>1316.00</td>
      <td>1316.00</td>
      <td>3.770910e+09</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1/24/2012</td>
      <td>1315.96</td>
      <td>1315.96</td>
      <td>1306.06</td>
      <td>1314.65</td>
      <td>1314.65</td>
      <td>3.693560e+09</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spy</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>close_adj</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1/18/2012</td>
      <td>129.31</td>
      <td>130.84</td>
      <td>129.08</td>
      <td>130.77</td>
      <td>107.98</td>
      <td>163395200.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1/19/2012</td>
      <td>131.22</td>
      <td>131.57</td>
      <td>130.80</td>
      <td>131.46</td>
      <td>108.55</td>
      <td>126328900.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1/20/2012</td>
      <td>131.24</td>
      <td>131.95</td>
      <td>130.92</td>
      <td>131.95</td>
      <td>108.95</td>
      <td>138230200.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1/23/2012</td>
      <td>131.51</td>
      <td>132.25</td>
      <td>130.98</td>
      <td>131.61</td>
      <td>108.67</td>
      <td>129295800.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1/24/2012</td>
      <td>130.80</td>
      <td>131.50</td>
      <td>130.60</td>
      <td>131.46</td>
      <td>108.55</td>
      <td>103083300.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="verify-that-the-spy-etf-is-correlated-with-the-s-p-500">
<h2>Verify that the SPY ETF is correlated with the S&amp;P 500<a class="headerlink" href="#verify-that-the-spy-etf-is-correlated-with-the-s-p-500" title="Permalink to this headline">Â¶</a></h2>
<p>We verify that the data sets are correlated, and as expected we find all features to be perfectly correlated, with exception to volume.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp500</span><span class="o">.</span><span class="n">corrwith</span><span class="p">(</span><span class="n">spy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>open         0.999946
high         0.999977
low          0.999981
close        0.999989
close_adj    0.999545
volume       0.512112
dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="feature-engineering">
<h2>Feature Engineering<a class="headerlink" href="#feature-engineering" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">spy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">close_adj</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">close_adj</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;d2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">close_adj</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">close_adj</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;d3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">close_adj</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">close_adj</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>date         0
open         0
high         0
low          0
close        0
close_adj    0
volume       0
d1           0
d2           0
d3           0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>close_adj</th>
      <th>volume</th>
      <th>d1</th>
      <th>d2</th>
      <th>d3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>1/23/2012</td>
      <td>131.51</td>
      <td>132.25</td>
      <td>130.98</td>
      <td>131.61</td>
      <td>108.67</td>
      <td>129295800.0</td>
      <td>0.997430</td>
      <td>1.001105</td>
      <td>1.006390</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1/24/2012</td>
      <td>130.80</td>
      <td>131.50</td>
      <td>130.60</td>
      <td>131.46</td>
      <td>108.55</td>
      <td>103083300.0</td>
      <td>0.998896</td>
      <td>0.996329</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1/25/2012</td>
      <td>131.26</td>
      <td>132.87</td>
      <td>130.75</td>
      <td>132.56</td>
      <td>109.45</td>
      <td>198613200.0</td>
      <td>1.008291</td>
      <td>1.007178</td>
      <td>1.004589</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1/26/2012</td>
      <td>133.15</td>
      <td>133.40</td>
      <td>131.36</td>
      <td>131.88</td>
      <td>108.89</td>
      <td>184880500.0</td>
      <td>0.994884</td>
      <td>1.003132</td>
      <td>1.002024</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1/27/2012</td>
      <td>131.24</td>
      <td>132.05</td>
      <td>131.15</td>
      <td>131.82</td>
      <td>108.84</td>
      <td>135259100.0</td>
      <td>0.999541</td>
      <td>0.994427</td>
      <td>1.002672</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2512</th>
      <td>1/10/2022</td>
      <td>462.70</td>
      <td>465.74</td>
      <td>456.60</td>
      <td>465.51</td>
      <td>465.51</td>
      <td>119362000.0</td>
      <td>0.998756</td>
      <td>0.994807</td>
      <td>0.993872</td>
    </tr>
    <tr>
      <th>2513</th>
      <td>1/11/2022</td>
      <td>465.23</td>
      <td>469.85</td>
      <td>462.05</td>
      <td>469.75</td>
      <td>469.75</td>
      <td>74303100.0</td>
      <td>1.009108</td>
      <td>1.007853</td>
      <td>1.003868</td>
    </tr>
    <tr>
      <th>2514</th>
      <td>1/12/2022</td>
      <td>471.59</td>
      <td>473.20</td>
      <td>468.94</td>
      <td>471.02</td>
      <td>471.02</td>
      <td>67605400.0</td>
      <td>1.002704</td>
      <td>1.011836</td>
      <td>1.010577</td>
    </tr>
    <tr>
      <th>2515</th>
      <td>1/13/2022</td>
      <td>472.19</td>
      <td>472.88</td>
      <td>463.44</td>
      <td>464.53</td>
      <td>464.53</td>
      <td>91173100.0</td>
      <td>0.986221</td>
      <td>0.988888</td>
      <td>0.997895</td>
    </tr>
    <tr>
      <th>2516</th>
      <td>1/14/2022</td>
      <td>461.19</td>
      <td>465.09</td>
      <td>459.90</td>
      <td>464.72</td>
      <td>464.72</td>
      <td>95849600.0</td>
      <td>1.000409</td>
      <td>0.986625</td>
      <td>0.989292</td>
    </tr>
  </tbody>
</table>
<p>2514 rows Ã— 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Average 1 day change&quot;</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Average 2 day change&quot;</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Average 3 day change&quot;</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Average 1 day change 1.0006290141455563
Average 2 day change 1.0012442175636804
Average 3 day change 1.0018774869018376
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_dist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">detail</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="p">):</span>
    <span class="n">vars_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">name</span>
    <span class="n">mu</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">xmin</span><span class="p">,</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">xmax</span><span class="p">,</span>
        <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">j</span> <span class="o">*</span> <span class="n">std</span><span class="p">,</span> 
                <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> 
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span>
                <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;-.&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="n">s</span><span class="o">*</span><span class="n">std</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">s</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;Mu: </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Std: </span><span class="si">{</span><span class="n">std</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">])</span>
    <span class="n">title</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Distribution of </span><span class="si">{</span><span class="n">vars_name</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">detail</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">detail</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
  
    <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_dist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">],</span> <span class="s2">&quot;Change over 1 Days&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/prelim_eda_16_0.png" src="_images/prelim_eda_16_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_dist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span> <span class="s2">&quot;Change over 2 Days&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/prelim_eda_17_0.png" src="_images/prelim_eda_17_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_dist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d3&#39;</span><span class="p">],</span> <span class="s2">&quot;Change over 3 Days&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/prelim_eda_18_0.png" src="_images/prelim_eda_18_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_z</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">column</span> <span class="o">-</span> <span class="n">column</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.01015847934240302
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d1_z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_z</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;d2_z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_z</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d2&#39;</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;d3_z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_z</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d3&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_dist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d1_z&#39;</span><span class="p">],</span> <span class="s2">&quot;Z-Score for Single Day Change&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/prelim_eda_22_0.png" src="_images/prelim_eda_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_dist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d2_z&#39;</span><span class="p">],</span> <span class="s2">&quot;Z-Score for Two Day Change&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/prelim_eda_23_0.png" src="_images/prelim_eda_23_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_dist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;d3_z&#39;</span><span class="p">],</span> <span class="s2">&quot;Z-Score for Three Day Change&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/prelim_eda_24_0.png" src="_images/prelim_eda_24_0.png" />
</div>
</div>
<div class="section" id="day-week-month">
<h3>Day Week Month<a class="headerlink" href="#day-week-month" title="Permalink to this headline">Â¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day_name</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month_name</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>close_adj</th>
      <th>volume</th>
      <th>d1</th>
      <th>d2</th>
      <th>d3</th>
      <th>d1_z</th>
      <th>d2_z</th>
      <th>d3_z</th>
      <th>day</th>
      <th>month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>2012-01-23</td>
      <td>131.51</td>
      <td>132.25</td>
      <td>130.98</td>
      <td>131.61</td>
      <td>108.67</td>
      <td>129295800.0</td>
      <td>0.997430</td>
      <td>1.001105</td>
      <td>1.006390</td>
      <td>-0.314909</td>
      <td>-0.010482</td>
      <td>0.275656</td>
      <td>Monday</td>
      <td>January</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2012-01-24</td>
      <td>130.80</td>
      <td>131.50</td>
      <td>130.60</td>
      <td>131.46</td>
      <td>108.55</td>
      <td>103083300.0</td>
      <td>0.998896</td>
      <td>0.996329</td>
      <td>1.000000</td>
      <td>-0.170623</td>
      <td>-0.371375</td>
      <td>-0.114688</td>
      <td>Tuesday</td>
      <td>January</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2012-01-25</td>
      <td>131.26</td>
      <td>132.87</td>
      <td>130.75</td>
      <td>132.56</td>
      <td>109.45</td>
      <td>198613200.0</td>
      <td>1.008291</td>
      <td>1.007178</td>
      <td>1.004589</td>
      <td>0.754256</td>
      <td>0.448274</td>
      <td>0.165651</td>
      <td>Wednesday</td>
      <td>January</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2012-01-26</td>
      <td>133.15</td>
      <td>133.40</td>
      <td>131.36</td>
      <td>131.88</td>
      <td>108.89</td>
      <td>184880500.0</td>
      <td>0.994884</td>
      <td>1.003132</td>
      <td>1.002024</td>
      <td>-0.565587</td>
      <td>0.142637</td>
      <td>0.008979</td>
      <td>Thursday</td>
      <td>January</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2012-01-27</td>
      <td>131.24</td>
      <td>132.05</td>
      <td>131.15</td>
      <td>131.82</td>
      <td>108.84</td>
      <td>135259100.0</td>
      <td>0.999541</td>
      <td>0.994427</td>
      <td>1.002672</td>
      <td>-0.107122</td>
      <td>-0.515065</td>
      <td>0.048508</td>
      <td>Friday</td>
      <td>January</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2512</th>
      <td>2022-01-10</td>
      <td>462.70</td>
      <td>465.74</td>
      <td>456.60</td>
      <td>465.51</td>
      <td>465.51</td>
      <td>119362000.0</td>
      <td>0.998756</td>
      <td>0.994807</td>
      <td>0.993872</td>
      <td>-0.184418</td>
      <td>-0.486329</td>
      <td>-0.488993</td>
      <td>Monday</td>
      <td>January</td>
    </tr>
    <tr>
      <th>2513</th>
      <td>2022-01-11</td>
      <td>465.23</td>
      <td>469.85</td>
      <td>462.05</td>
      <td>469.75</td>
      <td>469.75</td>
      <td>74303100.0</td>
      <td>1.009108</td>
      <td>1.007853</td>
      <td>1.003868</td>
      <td>0.834699</td>
      <td>0.499260</td>
      <td>0.121593</td>
      <td>Tuesday</td>
      <td>January</td>
    </tr>
    <tr>
      <th>2514</th>
      <td>2022-01-12</td>
      <td>471.59</td>
      <td>473.20</td>
      <td>468.94</td>
      <td>471.02</td>
      <td>471.02</td>
      <td>67605400.0</td>
      <td>1.002704</td>
      <td>1.011836</td>
      <td>1.010577</td>
      <td>0.204219</td>
      <td>0.800245</td>
      <td>0.531440</td>
      <td>Wednesday</td>
      <td>January</td>
    </tr>
    <tr>
      <th>2515</th>
      <td>2022-01-13</td>
      <td>472.19</td>
      <td>472.88</td>
      <td>463.44</td>
      <td>464.53</td>
      <td>464.53</td>
      <td>91173100.0</td>
      <td>0.986221</td>
      <td>0.988888</td>
      <td>0.997895</td>
      <td>-1.418285</td>
      <td>-0.933534</td>
      <td>-0.243287</td>
      <td>Thursday</td>
      <td>January</td>
    </tr>
    <tr>
      <th>2516</th>
      <td>2022-01-14</td>
      <td>461.19</td>
      <td>465.09</td>
      <td>459.90</td>
      <td>464.72</td>
      <td>464.72</td>
      <td>95849600.0</td>
      <td>1.000409</td>
      <td>0.986625</td>
      <td>0.989292</td>
      <td>-0.021657</td>
      <td>-1.104498</td>
      <td>-0.768786</td>
      <td>Friday</td>
      <td>January</td>
    </tr>
  </tbody>
</table>
<p>2514 rows Ã— 15 columns</p>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="baseline-model">
<h1>Baseline Model<a class="headerlink" href="#baseline-model" title="Permalink to this headline">Â¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drop_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="s1">&#39;d1_z&#39;</span><span class="p">,</span><span class="s2">&quot;d2_z&quot;</span><span class="p">,</span><span class="s2">&quot;d3_z&quot;</span><span class="p">]</span>
<span class="n">data_prepared</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">drop_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_prepared</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">data_prepared</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="n">data_prepared</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">data_prepared</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_prepared</span><span class="p">[</span><span class="n">columns</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_prepared</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">data_prepared</span><span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">],</span> <span class="n">data_prepared</span><span class="p">[</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span> <span class="n">data_prepared</span><span class="p">[</span><span class="s1">&#39;d3&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_prepared</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_prepared</span><span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">]</span>
<span class="n">data_d1</span> <span class="o">=</span> <span class="n">data_prepared</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">,</span><span class="s1">&#39;d2&#39;</span><span class="p">,</span><span class="s1">&#39;d3&#39;</span><span class="p">])</span>
<span class="n">data_d1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>close_adj</th>
      <th>day_Friday</th>
      <th>day_Monday</th>
      <th>day_Thursday</th>
      <th>day_Tuesday</th>
      <th>day_Wednesday</th>
      <th>month_April</th>
      <th>month_August</th>
      <th>month_December</th>
      <th>month_February</th>
      <th>month_January</th>
      <th>month_July</th>
      <th>month_June</th>
      <th>month_March</th>
      <th>month_May</th>
      <th>month_November</th>
      <th>month_October</th>
      <th>month_September</th>
      <th>output</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>0.006542</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.534040</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.006219</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.541368</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.008641</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.588339</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.007134</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.521309</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.006999</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.544593</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2512</th>
      <td>0.967158</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.540667</td>
    </tr>
    <tr>
      <th>2513</th>
      <td>0.978572</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.592425</td>
    </tr>
    <tr>
      <th>2514</th>
      <td>0.981990</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.560405</td>
    </tr>
    <tr>
      <th>2515</th>
      <td>0.964519</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.478004</td>
    </tr>
    <tr>
      <th>2516</th>
      <td>0.965031</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.548933</td>
    </tr>
  </tbody>
</table>
<p>2514 rows Ã— 19 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_zipped</span> <span class="o">=</span> <span class="n">data_prepared</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;d1&#39;</span><span class="p">,</span><span class="s1">&#39;d2&#39;</span><span class="p">,</span><span class="s1">&#39;d3&#39;</span><span class="p">])</span>
<span class="n">data_zipped</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>close_adj</th>
      <th>day_Friday</th>
      <th>day_Monday</th>
      <th>day_Thursday</th>
      <th>day_Tuesday</th>
      <th>day_Wednesday</th>
      <th>month_April</th>
      <th>month_August</th>
      <th>month_December</th>
      <th>month_February</th>
      <th>month_January</th>
      <th>month_July</th>
      <th>month_June</th>
      <th>month_March</th>
      <th>month_May</th>
      <th>month_November</th>
      <th>month_October</th>
      <th>month_September</th>
      <th>output</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>0.006542</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.534040</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.006219</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.541368</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.008641</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.588339</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.007134</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.521309</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.006999</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.544593</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2512</th>
      <td>0.967158</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.540667</td>
    </tr>
    <tr>
      <th>2513</th>
      <td>0.978572</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.592425</td>
    </tr>
    <tr>
      <th>2514</th>
      <td>0.981990</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.560405</td>
    </tr>
    <tr>
      <th>2515</th>
      <td>0.964519</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.478004</td>
    </tr>
    <tr>
      <th>2516</th>
      <td>0.965031</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.548933</td>
    </tr>
  </tbody>
</table>
<p>2514 rows Ã— 19 columns</p>
</div></div></div>
</div>
<div class="section" id="create-training-packets">
<h2>Create Training Packets<a class="headerlink" href="#create-training-packets" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span> <span class="o">=</span> <span class="n">data_d1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">records</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
<span class="n">records</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2514, 19)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">history</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">days</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">days</span><span class="p">:,</span><span class="n">output</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">60</span><span class="p">:</span><span class="n">i</span><span class="p">])</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="c1">#X = np.reshape(X, (X.shape[0], X.shape[1], 1))</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span><span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">features</span><span class="p">,</span> <span class="n">predictors</span> <span class="o">=</span> <span class="n">history</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Inputs </span><span class="si">{</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Outputs </span><span class="si">{</span><span class="n">predictors</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Inputs (2454, 60, 19)
Outputs (2454,)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="split-training-test">
<h2>Split Training/Test<a class="headerlink" href="#split-training-test" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">split</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="o">*</span><span class="mf">.74</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">split</span><span class="p">)</span>
<span class="n">split</span> <span class="o">=</span> <span class="mi">1792</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1815
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_training</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:</span><span class="n">split</span><span class="p">]</span>
<span class="n">y_training</span> <span class="o">=</span> <span class="n">predictors</span><span class="p">[:</span><span class="n">split</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="n">split</span><span class="p">:]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">predictors</span><span class="p">[</span><span class="n">split</span><span class="p">:]</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training Set: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_training</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_training</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test Set: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training Set: 1792, 1792
Test Set: 662, 662
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_training</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.52998409, 0.51470451, 0.55520568, ..., 0.56062278, 0.47953184,
       0.5341462 ])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="model">
<h2>Model<a class="headerlink" href="#model" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_training</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">X_training</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(60, 19)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">return_sequences</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_training</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_training</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">return_sequences</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">return_sequences</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">50</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model: &quot;sequential_3&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_12 (LSTM)               (None, 60, 50)            14000     
_________________________________________________________________
dropout_12 (Dropout)         (None, 60, 50)            0         
_________________________________________________________________
lstm_13 (LSTM)               (None, 60, 50)            20200     
_________________________________________________________________
dropout_13 (Dropout)         (None, 60, 50)            0         
_________________________________________________________________
lstm_14 (LSTM)               (None, 60, 50)            20200     
_________________________________________________________________
dropout_14 (Dropout)         (None, 60, 50)            0         
_________________________________________________________________
lstm_15 (LSTM)               (None, 50)                20200     
_________________________________________________________________
dropout_15 (Dropout)         (None, 50)                0         
_________________________________________________________________
dense_3 (Dense)              (None, 1)                 51        
=================================================================
Total params: 74,651
Trainable params: 74,651
Non-trainable params: 0
_________________________________________________________________
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">callback</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fitting the RNN to the Training set</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_training</span><span class="p">,</span> 
    <span class="n">y_training</span><span class="p">,</span> 
    <span class="n">epochs</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> 
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">validation_split</span> <span class="o">=</span> <span class="mf">.3</span><span class="p">,</span>
    <span class="n">callbacks</span> <span class="o">=</span> <span class="p">[</span><span class="n">callback</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/10000
1254/1254 [==============================] - 41s 29ms/step - loss: 0.0043 - val_loss: 0.0019
Epoch 2/10000
1254/1254 [==============================] - 33s 26ms/step - loss: 0.0028 - val_loss: 0.0018
Epoch 3/10000
1254/1254 [==============================] - 33s 26ms/step - loss: 0.0025 - val_loss: 0.0019
Epoch 4/10000
1254/1254 [==============================] - 31s 25ms/step - loss: 0.0023 - val_loss: 0.0019
Epoch 5/10000
1254/1254 [==============================] - 34s 27ms/step - loss: 0.0021 - val_loss: 0.0019
Epoch 6/10000
1254/1254 [==============================] - 32s 25ms/step - loss: 0.0019 - val_loss: 0.0018
Epoch 7/10000
1254/1254 [==============================] - 32s 25ms/step - loss: 0.0020 - val_loss: 0.0018
Epoch 8/10000
1254/1254 [==============================] - 31s 25ms/step - loss: 0.0019 - val_loss: 0.0018
Epoch 9/10000
1254/1254 [==============================] - 33s 27ms/step - loss: 0.0018 - val_loss: 0.0018
Epoch 10/10000
1254/1254 [==============================] - 34s 27ms/step - loss: 0.0017 - val_loss: 0.0018
Epoch 11/10000
1254/1254 [==============================] - 35s 28ms/step - loss: 0.0017 - val_loss: 0.0018
Epoch 12/10000
1254/1254 [==============================] - 34s 27ms/step - loss: 0.0017 - val_loss: 0.0018
Epoch 13/10000
1254/1254 [==============================] - 32s 26ms/step - loss: 0.0017 - val_loss: 0.0018
Epoch 14/10000
1254/1254 [==============================] - 33s 26ms/step - loss: 0.0017 - val_loss: 0.0018
Epoch 15/10000
1254/1254 [==============================] - 34s 27ms/step - loss: 0.0017 - val_loss: 0.0018 - loss: 0.00
Epoch 16/10000
1254/1254 [==============================] - 32s 26ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 17/10000
1254/1254 [==============================] - 33s 26ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 18/10000
1254/1254 [==============================] - 31s 25ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 19/10000
1254/1254 [==============================] - 32s 26ms/step - loss: 0.0017 - val_loss: 0.0018
Epoch 20/10000
1254/1254 [==============================] - 33s 26ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 21/10000
1254/1254 [==============================] - 32s 26ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 22/10000
1254/1254 [==============================] - 32s 26ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 23/10000
1254/1254 [==============================] - 32s 26ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 24/10000
1254/1254 [==============================] - 35s 28ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 25/10000
1254/1254 [==============================] - 34s 27ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 26/10000
1254/1254 [==============================] - 33s 27ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 27/10000
1254/1254 [==============================] - 34s 27ms/step - loss: 0.0016 - val_loss: 0.0018
Epoch 28/10000
1254/1254 [==============================] - 33s 27ms/step - loss: 0.0016 - val_loss: 0.0018
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>662
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21/21 [==============================] - 1s 28ms/step - loss: 0.0052
0.005207539536058903
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_change</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_change</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.5496757 ],
       [0.5502716 ],
       [0.550493  ],
       [0.55044675],
       [0.55036914],
       [0.55058324],
       [0.5506126 ],
       [0.55051374],
       [0.5503482 ],
       [0.55027884],
       [0.5505759 ],
       [0.5507009 ],
       [0.55064905],
       [0.55048555],
       [0.55038923],
       [0.55065197],
       [0.55074835],
       [0.5506732 ],
       [0.55049384],
       [0.55039036],
       [0.5503696 ],
       [0.5502516 ],
       [0.550085  ],
       [0.5498562 ],
       [0.549868  ],
       [0.54996043],
       [0.5500202 ],
       [0.5499344 ],
       [0.5498224 ],
       [0.54994696],
       [0.55010545],
       [0.55016947],
       [0.55005246],
       [0.5498954 ],
       [0.5499848 ],
       [0.5501144 ],
       [0.55015904],
       [0.55002874],
       [0.54987234],
       [0.54996276],
       [0.5500957 ],
       [0.5501445 ],
       [0.55002904],
       [0.5498878 ],
       [0.54995894],
       [0.55001795],
       [0.5499434 ],
       [0.54974467],
       [0.54957074],
       [0.5496121 ],
       [0.54964924],
       [0.5496091 ],
       [0.5494755 ],
       [0.5493781 ],
       [0.5494776 ],
       [0.54956585],
       [0.5495723 ],
       [0.5494662 ],
       [0.5493766 ],
       [0.5494887 ],
       [0.54958916],
       [0.54960084],
       [0.5494952 ],
       [0.54940367],
       [0.5495221 ],
       [0.54964393],
       [0.54963744],
       [0.5496209 ],
       [0.54974806],
       [0.5497118 ],
       [0.5495104 ],
       [0.5492227 ],
       [0.5490449 ],
       [0.5490882 ],
       [0.54914975],
       [0.5491106 ],
       [0.54896134],
       [0.5488746 ],
       [0.54897004],
       [0.5490733 ],
       [0.54906493],
       [0.5489327 ],
       [0.54885453],
       [0.5489542 ],
       [0.5490686 ],
       [0.5491307 ],
       [0.5491238 ],
       [0.5491803 ],
       [0.5494645 ],
       [0.54976445],
       [0.54992163],
       [0.5499356 ],
       [0.5499386 ],
       [0.55009663],
       [0.5501499 ],
       [0.5501046 ],
       [0.55000037],
       [0.54994345],
       [0.5500737 ],
       [0.55012184],
       [0.55008274],
       [0.5499855 ],
       [0.5499329 ],
       [0.550066  ],
       [0.55011886],
       [0.55008286],
       [0.549987  ],
       [0.54998547],
       [0.55019575],
       [0.55032474],
       [0.5504263 ],
       [0.550497  ],
       [0.55056024],
       [0.5508209 ],
       [0.55104005],
       [0.55119157],
       [0.551229  ],
       [0.55118185],
       [0.55130005],
       [0.5513871 ],
       [0.5514204 ],
       [0.55136275],
       [0.5512465 ],
       [0.55132186],
       [0.5513833 ],
       [0.5514012 ],
       [0.5513005 ],
       [0.5513796 ],
       [0.55132735],
       [0.55111516],
       [0.55079633],
       [0.55057883],
       [0.5506984 ],
       [0.5506874 ],
       [0.5505239 ],
       [0.5502968 ],
       [0.5502058 ],
       [0.5504115 ],
       [0.5504386 ],
       [0.55032766],
       [0.55015826],
       [0.55011165],
       [0.55035645],
       [0.5504287 ],
       [0.55032706],
       [0.55025387],
       [0.5504544 ],
       [0.55048966],
       [0.55006075],
       [0.5494978 ],
       [0.5491795 ],
       [0.54908675],
       [0.5491005 ],
       [0.5490217 ],
       [0.5489382 ],
       [0.54908025],
       [0.5493637 ],
       [0.54953486],
       [0.5493959 ],
       [0.54916483],
       [0.54906595],
       [0.54908276],
       [0.54901266],
       [0.5489432 ],
       [0.54909587],
       [0.54935145],
       [0.5494525 ],
       [0.54925543],
       [0.5489976 ],
       [0.5494754 ],
       [0.5502263 ],
       [0.55072165],
       [0.55089974],
       [0.5509277 ],
       [0.55113447],
       [0.5511065 ],
       [0.5509234 ],
       [0.5507087 ],
       [0.5506097 ],
       [0.5506116 ],
       [0.55062574],
       [0.5506199 ],
       [0.55066526],
       [0.5509812 ],
       [0.551066  ],
       [0.55094945],
       [0.55076045],
       [0.550672  ],
       [0.5504271 ],
       [0.54988563],
       [0.5493244 ],
       [0.5488274 ],
       [0.54849494],
       [0.54828876],
       [0.54825914],
       [0.5482677 ],
       [0.5482139 ],
       [0.5481943 ],
       [0.54817945],
       [0.548259  ],
       [0.5483145 ],
       [0.5482893 ],
       [0.5482345 ],
       [0.54821646],
       [0.5482966 ],
       [0.54836065],
       [0.54834104],
       [0.5482798 ],
       [0.54825544],
       [0.54829544],
       [0.5483316 ],
       [0.54838234],
       [0.54861563],
       [0.5492502 ],
       [0.5497216 ],
       [0.54982644],
       [0.5497553 ],
       [0.549975  ],
       [0.54993236],
       [0.5497716 ],
       [0.54960215],
       [0.5496038 ],
       [0.54983187],
       [0.5498262 ],
       [0.5496975 ],
       [0.54954803],
       [0.5495615 ],
       [0.54979646],
       [0.5497998 ],
       [0.5496756 ],
       [0.54952574],
       [0.5493604 ],
       [0.5492931 ],
       [0.54914373],
       [0.5489766 ],
       [0.5487713 ],
       [0.5486646 ],
       [0.54875535],
       [0.5489617 ],
       [0.54914796],
       [0.5491794 ],
       [0.5491777 ],
       [0.549304  ],
       [0.54943293],
       [0.54945755],
       [0.54930377],
       [0.54917055],
       [0.5491114 ],
       [0.5491256 ],
       [0.54907566],
       [0.5490734 ],
       [0.549638  ],
       [0.5502222 ],
       [0.550446  ],
       [0.5504021 ],
       [0.55032593],
       [0.55052936],
       [0.5505574 ],
       [0.55045694],
       [0.5502932 ],
       [0.55023706],
       [0.5505354 ],
       [0.5506588 ],
       [0.55060476],
       [0.55044055],
       [0.55034846],
       [0.55060923],
       [0.5507037 ],
       [0.5506303 ],
       [0.55045545],
       [0.55035853],
       [0.55061764],
       [0.55070823],
       [0.55048776],
       [0.5500892 ],
       [0.54990643],
       [0.5498569 ],
       [0.5498615 ],
       [0.54978067],
       [0.5497089 ],
       [0.54987353],
       [0.5500689 ],
       [0.5501536 ],
       [0.55003864],
       [0.5498807 ],
       [0.5499585 ],
       [0.5500779 ],
       [0.55011845],
       [0.5499864 ],
       [0.5498315 ],
       [0.54992276],
       [0.55005825],
       [0.5501124 ],
       [0.5499896 ],
       [0.5498396 ],
       [0.5499155 ],
       [0.55002755],
       [0.5500143 ],
       [0.5498434 ],
       [0.5496702 ],
       [0.54969066],
       [0.54970676],
       [0.54964346],
       [0.5494805 ],
       [0.54935694],
       [0.5494286 ],
       [0.5495044 ],
       [0.54950476],
       [0.5493981 ],
       [0.5493136 ],
       [0.54941064],
       [0.549505  ],
       [0.54951656],
       [0.54941195],
       [0.5493252 ],
       [0.5494171 ],
       [0.5496148 ],
       [0.54969233],
       [0.5495948 ],
       [0.5495087 ],
       [0.5494302 ],
       [0.54931724],
       [0.5491338 ],
       [0.5490408 ],
       [0.54913807],
       [0.5492121 ],
       [0.5491578 ],
       [0.54898703],
       [0.548882  ],
       [0.5489579 ],
       [0.5490496 ],
       [0.5490331 ],
       [0.54890335],
       [0.54883265],
       [0.54892653],
       [0.5490279 ],
       [0.5490242 ],
       [0.5489374 ],
       [0.5488801 ],
       [0.549018  ],
       [0.5492927 ],
       [0.549532  ],
       [0.54963917],
       [0.549723  ],
       [0.5499361 ],
       [0.5500497 ],
       [0.55004007],
       [0.54995054],
       [0.5498996 ],
       [0.5500272 ],
       [0.550076  ],
       [0.5500365 ],
       [0.54993695],
       [0.5498824 ],
       [0.5500115 ],
       [0.55006766],
       [0.5500383 ],
       [0.54994833],
       [0.54989994],
       [0.5500804 ],
       [0.55019   ],
       [0.5502616 ],
       [0.5503052 ],
       [0.550357  ],
       [0.5506069 ],
       [0.550828  ],
       [0.55099607],
       [0.5510619 ],
       [0.55105156],
       [0.551193  ],
       [0.5512975 ],
       [0.5513434 ],
       [0.5512976 ],
       [0.5511907 ],
       [0.55126834],
       [0.5513313 ],
       [0.5513466 ],
       [0.55124754],
       [0.5513006 ],
       [0.5512946 ],
       [0.55115473],
       [0.550884  ],
       [0.55066043],
       [0.55073124],
       [0.55068636],
       [0.5504979 ],
       [0.55025184],
       [0.5501512 ],
       [0.5503463 ],
       [0.55036795],
       [0.55024666],
       [0.55006635],
       [0.550015  ],
       [0.5502467 ],
       [0.55031383],
       [0.55023855],
       [0.5500902 ],
       [0.55026066],
       [0.5502999 ],
       [0.5502196 ],
       [0.5500729 ],
       [0.54986185],
       [0.5495291 ],
       [0.5491968 ],
       [0.5488492 ],
       [0.5486174 ],
       [0.54865307],
       [0.54894114],
       [0.5492435 ],
       [0.54926866],
       [0.54915345],
       [0.54912347],
       [0.5491665 ],
       [0.54908246],
       [0.5489811 ],
       [0.5490798 ],
       [0.54928124],
       [0.54935396],
       [0.54916966],
       [0.54893357],
       [0.549403  ],
       [0.550156  ],
       [0.5506576 ],
       [0.55083746],
       [0.55086106],
       [0.5510503 ],
       [0.5510157 ],
       [0.5508323 ],
       [0.55062103],
       [0.55052614],
       [0.5505293 ],
       [0.5505437 ],
       [0.5505373 ],
       [0.5505831 ],
       [0.5508786 ],
       [0.550953  ],
       [0.5508332 ],
       [0.5506425 ],
       [0.55055076],
       [0.55029655],
       [0.54978245],
       [0.54924047],
       [0.5487766 ],
       [0.5484713 ],
       [0.5482863 ],
       [0.5482452 ],
       [0.5482525 ],
       [0.5482195 ],
       [0.548179  ],
       [0.5481551 ],
       [0.5481989 ],
       [0.5482477 ],
       [0.5482238 ],
       [0.5481837 ],
       [0.5481597 ],
       [0.54820234],
       [0.5482496 ],
       [0.5482297 ],
       [0.54819435],
       [0.54816973],
       [0.5482107 ],
       [0.54825675],
       [0.5482225 ],
       [0.5483105 ],
       [0.548579  ],
       [0.54888356],
       [0.54908776],
       [0.5493366 ],
       [0.5497058 ],
       [0.5497621 ],
       [0.54962575],
       [0.549443  ],
       [0.54942334],
       [0.5496212 ],
       [0.5496171 ],
       [0.5494967 ],
       [0.5493448 ],
       [0.54935414],
       [0.5495716 ],
       [0.54958403],
       [0.5494761 ],
       [0.549331  ],
       [0.5493419 ],
       [0.5493403 ],
       [0.54918575],
       [0.54898083],
       [0.5487313 ],
       [0.54857457],
       [0.5485717 ],
       [0.54869497],
       [0.54884106],
       [0.5488846 ],
       [0.5489228 ],
       [0.5490549 ],
       [0.5492195 ],
       [0.5492909 ],
       [0.54919356],
       [0.54908794],
       [0.54910797],
       [0.54919004],
       [0.5492142 ],
       [0.5490972 ],
       [0.54899836],
       [0.54921794],
       [0.5496329 ],
       [0.54994047],
       [0.5501525 ],
       [0.5504866 ],
       [0.55052996],
       [0.55038476],
       [0.5501647 ],
       [0.5500616 ],
       [0.5503105 ],
       [0.55042857],
       [0.5503842 ],
       [0.5502333 ],
       [0.5501582 ],
       [0.5504064 ],
       [0.5505055 ],
       [0.5504348 ],
       [0.550261  ],
       [0.5501675 ],
       [0.55040365],
       [0.55049723],
       [0.55042464],
       [0.55011594],
       [0.5497882 ],
       [0.54963255],
       [0.5496148 ],
       [0.5495716 ],
       [0.5495591 ],
       [0.5497462 ],
       [0.5499454 ],
       [0.5500238 ],
       [0.5499056 ],
       [0.5497488 ],
       [0.54980826],
       [0.5499267 ],
       [0.54997146],
       [0.5498521 ],
       [0.54971224],
       [0.5497824 ],
       [0.5499025 ],
       [0.5499492 ],
       [0.54983526],
       [0.54969704],
       [0.5497619 ],
       [0.5498722 ],
       [0.5498607 ],
       [0.5496965 ],
       [0.5495312 ],
       [0.5495333 ],
       [0.5495526 ],
       [0.5495014 ],
       [0.5493529 ],
       [0.5492394 ],
       [0.5492939 ],
       [0.5493698 ],
       [0.54937804],
       [0.54927987],
       [0.5492032 ],
       [0.5492821 ],
       [0.54937357],
       [0.5493894 ],
       [0.5492905 ],
       [0.5492113 ],
       [0.5492862 ],
       [0.54937613],
       [0.54945165],
       [0.54942876],
       [0.5494255 ],
       [0.54940945],
       [0.5493199 ],
       [0.54914427],
       [0.5490399 ],
       [0.54909974],
       [0.54914653],
       [0.5490874 ],
       [0.54892445],
       [0.5488228 ],
       [0.54887396],
       [0.54895353],
       [0.5489487 ],
       [0.5488366 ],
       [0.5487692 ],
       [0.5488377 ],
       [0.54892737],
       [0.54892987],
       [0.54881805],
       [0.54876393],
       [0.5488389 ],
       [0.54905134],
       [0.5492615 ],
       [0.549371  ],
       [0.5494741 ],
       [0.54971033],
       [0.5498812 ],
       [0.5499181 ],
       [0.54985064],
       [0.5498043 ],
       [0.5499113 ],
       [0.5499626 ],
       [0.549928  ],
       [0.54982835],
       [0.54977345],
       [0.5498818 ],
       [0.5499409 ],
       [0.5499151 ],
       [0.5498218 ],
       [0.54976916],
       [0.54992515],
       [0.55004543],
       [0.55013037],
       [0.55018395],
       [0.5502458 ],
       [0.5504881 ],
       [0.5507033 ],
       [0.5508621 ],
       [0.5509257 ],
       [0.55092025],
       [0.55105853],
       [0.5511646 ],
       [0.5512072 ],
       [0.5511617 ],
       [0.5510627 ],
       [0.5511361 ],
       [0.5512012 ],
       [0.5512187 ],
       [0.5511266 ],
       [0.55117697],
       [0.55121017],
       [0.55113506],
       [0.5509281 ],
       [0.55071324],
       [0.550738  ],
       [0.55065525],
       [0.5504368 ],
       [0.55016047],
       [0.55003655],
       [0.55019295],
       [0.5502148 ],
       [0.5500987 ],
       [0.54991597],
       [0.5498646 ],
       [0.55007637],
       [0.5501355 ],
       [0.55005455],
       [0.5499011 ],
       [0.55004245],
       [0.5500754 ],
       [0.5499998 ],
       [0.5498598 ],
       [0.54983693],
       [0.54970145],
       [0.54942423],
       [0.54911083],
       [0.54877126],
       [0.54854053],
       [0.5485498 ],
       [0.5488031 ],
       [0.54908377],
       [0.5491121 ]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.plot(data.loc[800:, â€˜Dateâ€™],dataset_test.values, color = â€˜redâ€™, label = â€˜Real TESLA Stock Priceâ€™)
plt.plot(df.loc[800:, â€˜Dateâ€™],predicted_change, color = â€˜blueâ€™, label = â€˜Predicted TESLA Stock Priceâ€™)
plt.xticks(np.arange(0,459,50))
plt.title(&#39;TESLA Stock Price Prediction&#39;)
plt.xlabel(&#39;Time&#39;)
plt.ylabel(&#39;TESLA Stock Price&#39;)
plt.legend()
plt.show()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2514
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>close_adj</th>
      <th>volume</th>
      <th>d1</th>
      <th>d2</th>
      <th>d3</th>
      <th>d1_z</th>
      <th>d2_z</th>
      <th>d3_z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>1/23/2012</td>
      <td>131.51</td>
      <td>132.25</td>
      <td>130.98</td>
      <td>131.61</td>
      <td>108.67</td>
      <td>129295800.0</td>
      <td>0.997430</td>
      <td>1.001105</td>
      <td>1.006390</td>
      <td>-0.314909</td>
      <td>-0.010482</td>
      <td>0.275656</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1/24/2012</td>
      <td>130.80</td>
      <td>131.50</td>
      <td>130.60</td>
      <td>131.46</td>
      <td>108.55</td>
      <td>103083300.0</td>
      <td>0.998896</td>
      <td>0.996329</td>
      <td>1.000000</td>
      <td>-0.170623</td>
      <td>-0.371375</td>
      <td>-0.114688</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1/25/2012</td>
      <td>131.26</td>
      <td>132.87</td>
      <td>130.75</td>
      <td>132.56</td>
      <td>109.45</td>
      <td>198613200.0</td>
      <td>1.008291</td>
      <td>1.007178</td>
      <td>1.004589</td>
      <td>0.754256</td>
      <td>0.448274</td>
      <td>0.165651</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1/26/2012</td>
      <td>133.15</td>
      <td>133.40</td>
      <td>131.36</td>
      <td>131.88</td>
      <td>108.89</td>
      <td>184880500.0</td>
      <td>0.994884</td>
      <td>1.003132</td>
      <td>1.002024</td>
      <td>-0.565587</td>
      <td>0.142637</td>
      <td>0.008979</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1/27/2012</td>
      <td>131.24</td>
      <td>132.05</td>
      <td>131.15</td>
      <td>131.82</td>
      <td>108.84</td>
      <td>135259100.0</td>
      <td>0.999541</td>
      <td>0.994427</td>
      <td>1.002672</td>
      <td>-0.107122</td>
      <td>-0.515065</td>
      <td>0.048508</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2512</th>
      <td>1/10/2022</td>
      <td>462.70</td>
      <td>465.74</td>
      <td>456.60</td>
      <td>465.51</td>
      <td>465.51</td>
      <td>119362000.0</td>
      <td>0.998756</td>
      <td>0.994807</td>
      <td>0.993872</td>
      <td>-0.184418</td>
      <td>-0.486329</td>
      <td>-0.488993</td>
    </tr>
    <tr>
      <th>2513</th>
      <td>1/11/2022</td>
      <td>465.23</td>
      <td>469.85</td>
      <td>462.05</td>
      <td>469.75</td>
      <td>469.75</td>
      <td>74303100.0</td>
      <td>1.009108</td>
      <td>1.007853</td>
      <td>1.003868</td>
      <td>0.834699</td>
      <td>0.499260</td>
      <td>0.121593</td>
    </tr>
    <tr>
      <th>2514</th>
      <td>1/12/2022</td>
      <td>471.59</td>
      <td>473.20</td>
      <td>468.94</td>
      <td>471.02</td>
      <td>471.02</td>
      <td>67605400.0</td>
      <td>1.002704</td>
      <td>1.011836</td>
      <td>1.010577</td>
      <td>0.204219</td>
      <td>0.800245</td>
      <td>0.531440</td>
    </tr>
    <tr>
      <th>2515</th>
      <td>1/13/2022</td>
      <td>472.19</td>
      <td>472.88</td>
      <td>463.44</td>
      <td>464.53</td>
      <td>464.53</td>
      <td>91173100.0</td>
      <td>0.986221</td>
      <td>0.988888</td>
      <td>0.997895</td>
      <td>-1.418285</td>
      <td>-0.933534</td>
      <td>-0.243287</td>
    </tr>
    <tr>
      <th>2516</th>
      <td>1/14/2022</td>
      <td>461.19</td>
      <td>465.09</td>
      <td>459.90</td>
      <td>464.72</td>
      <td>464.72</td>
      <td>95849600.0</td>
      <td>1.000409</td>
      <td>0.986625</td>
      <td>0.989292</td>
      <td>-0.021657</td>
      <td>-1.104498</td>
      <td>-0.768786</td>
    </tr>
  </tbody>
</table>
<p>2514 rows Ã— 13 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_scaled</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(755, 4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">engineer_memory</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">history</span><span class="p">,</span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Andrew Damico<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>